# ============================================
# SFI Dashboard Monitoring - Environment Template
# Phases 1 & 2 - Security & Observability
# ============================================
# IMPORTANT: Copier vers .env et remplir les valeurs
# cp .env.template .env
# ============================================

# ==========================================
# PHASE 1 - Sécurité Critique
# ==========================================

# JWT Configuration - GÉNÉRER AVEC: openssl rand -base64 32
JWT_SECRET=your_super_secret_jwt_key_change_in_production
JWT_REFRESH_SECRET=your_super_secret_refresh_key_change_in_production

# Session Secret (pour CSRF) - GÉNÉRER AVEC: openssl rand -base64 32
SESSION_SECRET=your_super_secret_session_key_change_in_production

# Token Expiration (en secondes)
JWT_EXPIRATION=3600           # 1 heure pour access token
REFRESH_TOKEN_EXPIRATION=604800 # 7 jours pour refresh token

# ==========================================
# PHASE 2 - Observabilité
# ==========================================

# Prometheus Metrics (optionnel)
METRICS_ENABLED=true
METRICS_PORT=3001

# ==========================================
# Base Configuration
# ==========================================

# Serveur
PORT=3001
HOST=0.0.0.0
NODE_ENV=development  # development | production

# Frontend CORS URLs (espace ou virgule séparées)
# IMPORTANT: Inclure HTTPS en production, sans slash à la fin
FRONTEND_URL=http://localhost:3000

# Session Configuration
SESSION_MAX_AGE=604800000      # 7 jours (ms)
SESSION_COOKIE_SECURE=false    # true en HTTPS/production
SESSION_COOKIE_HTTPONLY=true   # TOUJOURS true pour sécurité
SESSION_COOKIE_SAMESITE=lax    # lax | strict | false

# ==========================================
# Elasticsearch Configuration
# ==========================================

ES_NODE=https://172.27.28.14:9200
ES_USERNAME=elastic
ES_PASSWORD=votre_mot_de_passe
ES_INDEX=filebeat-*

# Certificat SSL (3 options)
# OPTION 1: Chemin au CA certificate (RECOMMANDÉ PRODUCTION)
ES_CERT_PATH=./certs/http_ca.crt

# OPTION 2: Désactiver vérification SSL (DEV SEULEMENT)
# ES_SSL_VERIFY=false

# OPTION 3: Fingerprint du certificat
# ES_FINGERPRINT=votre_fingerprint_ici

# Timeout Elasticsearch
ES_TIMEOUT=30000  # 30 secondes

# ==========================================
# Database Configuration
# ==========================================

# Sequelize
DB_TYPE=sqlite              # sqlite | mysql | postgres
DB_NAME=sfi_dashboard_dev
DB_USER=root
DB_PASSWORD=
DB_HOST=localhost
DB_PORT=3306
DB_DIALECT=sqlite

# SQLite (défaut)
DB_STORAGE=./data/database.sqlite

# ==========================================
# Logging Configuration
# ==========================================

LOG_LEVEL=info              # error | warn | info | debug
LOG_FORMAT=combined         # Morgan format
LOG_FILE=./logs/server.log

# ==========================================
# Authentication Configuration
# ==========================================

# Sessions max par utilisateur
MAX_SESSIONS_PER_USER=5

# Password Policy
MIN_PASSWORD_LENGTH=8
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=false

# Rate Limiting
RATE_LIMIT_WINDOW=15        # minutes
RATE_LIMIT_MAX_REQUESTS=100 # par window

# Auth Endpoints Rate Limiting
AUTH_RATE_LIMIT_WINDOW=1    # minute
AUTH_RATE_LIMIT_MAX=5       # tentatives signin
REFRESH_RATE_LIMIT_MAX=10   # tentatives refresh

# ==========================================
# CORS Configuration
# ==========================================

CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_HEADERS=Content-Type,Authorization,X-CSRF-Token

# ==========================================
# API Documentation (Swagger)
# ==========================================

SWAGGER_ENABLED=true
SWAGGER_PATH=/api/docs

# ==========================================
# Production Configuration
# ==========================================

# HTTPS Configuration (production)
# ENABLE_HTTPS=true
# CERT_PATH=/etc/ssl/certs/cert.pem
# KEY_PATH=/etc/ssl/private/key.pem

# Trusted Proxies (si derrière reverse proxy)
# TRUST_PROXY=true

# Security Headers
ENABLE_HELMET=true
ENABLE_HPP=true    # HTTP Parameter Pollution protection

# ==========================================
# Développement Configuration
# ==========================================

# Socket.IO Debug
SOCKET_IO_DEBUG=false

# API Response Logging
LOG_RESPONSES=false

# ==========================================
# Monitoring et Alertes (optionnel)
# ==========================================

# Sentry Error Tracking (optionnel)
# SENTRY_DSN=

# DataDog APM (optionnel)
# DD_ENABLED=false
# DD_AGENT_HOST=localhost
# DD_AGENT_PORT=8126

# ==========================================
# Mail Configuration (optionnel)
# ==========================================

# Pour reset password, email notifications
# MAIL_HOST=smtp.gmail.com
# MAIL_PORT=587
# MAIL_USER=your_email@gmail.com
# MAIL_PASSWORD=your_app_password
# MAIL_FROM=noreply@sfi-dashboard.com

# ==========================================
# Génération des Secrets
# ==========================================
#
# Créer des secrets sécurisés:
# 
# $ openssl rand -base64 32
# 
# Puis copier les valeurs générées dans .env
# JWT_SECRET=<valeur générée>
# JWT_REFRESH_SECRET=<valeur générée>
# SESSION_SECRET=<valeur générée>
#
# ============================================
